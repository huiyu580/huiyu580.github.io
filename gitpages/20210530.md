# 2021/05/30 小賴老師上課筆記

## Javascript 的 Callback, Promise, Async / Await

### callback function

**callback function 不一定是非同步，但是要非同步必須用到 callback function**

#### 需要按照先後順序處理的工作

- 註冊帳號: 先驗證 -> 建立新帳號
- 以下的 morning routine 作為範例  
  在非同步的程式語言中，會用到 callback function 內包含 callback function 來解決必須按照順許處理的工作  
  在下面範例中，在 stack 中執行刷牙工作時，其中的 cb function 會被排入 queue 中，等待刷牙工作執行完成會被執行，如此一直重複直到最內層的吃午餐工作被執行完畢

```javascript
let doWork = function (job, timer, cb) {
  setTimeout(() => {
    let dt = new Date();
    cb(null, `完成工作: ${job} at ${dt.toISOString()}`);
  }, timer);
};

let dt = new Date();
console.log(`開始工作 at ${dt.toISOString()}`);
doWork("刷牙", 2000, function (err, result) {
  if (err) {
    console.error(err);
    return;
  }
  console.log(result);
  doWork("吃早餐", 3000, function (err, result) {
    if (err) {
      console.error(err);
      return;
    }
    console.log(result);

    doWork("寫功課", 5000, function (err, result) {
      if (err) {
        console.error(err);
        return;
      }
      console.log(result);

      doWork("吃午餐", 3000, function (err, result) {
        if (err) {
          console.error(err);
          return;
        }
        console.log(result);
      });
    });
  });
});
```

**以上的問題是會產生 callback hell，讓程式變得不易閱讀和維護**，要解決以上的問題可以使用**Promise**
